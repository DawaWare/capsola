"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9083],{7266:(C,f,i)=>{i.d(f,{T:()=>p,_:()=>h});const h="https://dawaware.github.io/website",p=`${h}/api/v5/drugs.json`},9083:(C,f,i)=>{i.r(f),i.d(f,{TabsPageModule:()=>G});var h=i(6895),p=i(433),a=i(4556),c=i(1407),P=i(655),u=i(7579),T=i(727);class v extends T.w0{constructor(o,t){super()}schedule(o,t=0){return this}}const x={setInterval(s,o,...t){const{delegate:n}=x;return null!=n&&n.setInterval?n.setInterval(s,o,...t):setInterval(s,o,...t)},clearInterval(s){const{delegate:o}=x;return((null==o?void 0:o.clearInterval)||clearInterval)(s)},delegate:void 0};var g=i(8737);const S={now:()=>(S.delegate||Date).now(),delegate:void 0};class y{constructor(o,t=y.now){this.schedulerActionCtor=o,this.now=t}schedule(o,t=0,n){return new this.schedulerActionCtor(this,o).schedule(n,t)}}y.now=S.now;const Z=new class O extends y{constructor(o,t=y.now){super(o,t),this.actions=[],this._active=!1}flush(o){const{actions:t}=this;if(this._active)return void t.push(o);let n;this._active=!0;do{if(n=o.execute(o.state,o.delay))break}while(o=t.shift());if(this._active=!1,n){for(;o=t.shift();)o.unsubscribe();throw n}}}(class d extends v{constructor(o,t){super(o,t),this.scheduler=o,this.work=t,this.pending=!1}schedule(o,t=0){var n;if(this.closed)return this;this.state=o;const r=this.id,l=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(l,r,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(l,this.id,t),this}requestAsyncId(o,t,n=0){return x.setInterval(o.flush.bind(o,this),n)}recycleAsyncId(o,t,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&x.clearInterval(t)}execute(o,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(o,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(o,t){let r,n=!1;try{this.work(o)}catch(l){n=!0,r=l||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:o,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,(0,g.P)(n,this),null!=o&&(this.id=this.recycleAsyncId(t,o,null)),this.delay=null,super.unsubscribe()}}});var w=i(4482),U=i(5403),E=i(7266),e=i(8256),H=i(649),N=i(1188),J=i(5260);function K(s,o){1&s&&(e.TgZ(0,"h3"),e._uU(1,"Fetching drugs, please wait..."),e.qZA())}function _(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"div",13)(1,"ion-text",14)(2,"h3"),e._uU(3," No Drugs Found for input "),e.TgZ(4,"ion-text",0),e._uU(5),e.qZA(),e._uU(6," do you want to use AI to find the required drug? "),e.qZA(),e.TgZ(7,"ion-button",15),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.doApproximateSearch())}),e._uU(8,"Use AI"),e.qZA()()()}if(2&s){const t=e.oxw();e.xp6(5),e.Oqu(t.searchTerm)}}function B(s,o){1&s&&(e.TgZ(0,"div",13)(1,"ion-text",14)(2,"h3"),e._uU(3,"No history available yet"),e.qZA()()())}function R(s,o){if(1&s&&(e.TgZ(0,"p",22),e._uU(1),e.qZA()),2&s){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.activeingredient||"No Known ActiveIngredient"," ")}}function $(s,o){if(1&s&&(e.TgZ(0,"p",22),e._uU(1),e.qZA()),2&s){const t=e.oxw().$implicit,n=e.oxw();e.xp6(1),e.hij(" ",t[n.searchKey]," ")}}function L(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"div")(1,"div",16),e.NdJ("click",function(){const l=e.CHM(t).$implicit,m=e.oxw();return e.KtG(m.openDrugDetails(l))}),e.TgZ(2,"div",17),e._UZ(3,"ion-img",18),e.qZA(),e.TgZ(4,"div",19)(5,"ion-text",0)(6,"h3",20),e._uU(7),e.qZA()(),e.TgZ(8,"ion-text",14),e.YNc(9,R,2,1,"p",21),e.YNc(10,$,2,1,"p",21),e.qZA()()()()}if(2&s){const t=o.$implicit,n=e.oxw();e.xp6(3),e.Q6J("src",n.getDrugImage(t.id)),e.xp6(4),e.Oqu(t.tradename),e.xp6(2),e.Q6J("ngIf","tradename"===n.searchKey),e.xp6(1),e.Q6J("ngIf","tradename"!==n.searchKey)}}let I=(()=>{class s{constructor(t,n,r,l,m,b){this.drugsService=t,this.alertController=n,this.storage=r,this.router=l,this.route=m,this.analytics=b,this.searchTerm="",this.searchTerm$=new u.x,this.drugs=[],this.drugsToShow=[],this.worker=new Worker(i.tu(new URL(i.p+i.u(954),i.b))),this.searchType="exact",this.searchKey="tradename",this.segmentType="all",this.drugsHistory=[],this.noHistory=!1,this.isLoading=!0}ngOnInit(){this.analytics.setSecreenName("Home"),this.drugsService.drugs$.subscribe(t=>{this.drugs=t,this.worker.postMessage({drugs:this.drugs}),this.drugsToShow=this.drugs,setTimeout(()=>{this.isLoading=!1},200),this.prepareSearch(),this.showSearchResults()}),this.route.queryParams.subscribe(()=>{var t,n;const r=null===(n=null===(t=this.router.getCurrentNavigation())||void 0===t?void 0:t.extras)||void 0===n?void 0:n.queryParams;r&&r.searchTerm&&r.searchKey&&r.searchType&&(this.searchKey=r.searchKey,this.searchTerm=r.searchTerm,this.searchType=r.searchType,this.doSearch(r.searchTerm,r.searchKey,r.searchType))})}onSearchInput(t){this.searchTerm$.next(t.target.value)}prepareSearch(){this.searchTerm$.pipe(function D(s,o=Z){return(0,w.e)((t,n)=>{let r=null,l=null,m=null;const b=()=>{if(r){r.unsubscribe(),r=null;const M=l;l=null,n.next(M)}};function Q(){const M=m+s,A=o.now();if(A<M)return r=this.schedule(void 0,M-A),void n.add(r);b()}t.subscribe((0,U.x)(n,M=>{l=M,m=o.now(),r||(r=o.schedule(Q,s),n.add(r))},()=>{b(),n.complete()},void 0,()=>{l=r=null}))})}(200)).subscribe(t=>{console.time("Search took: "),this.searchTerm=t,this.doSearch(t)})}doSearch(t,n,r){0!==t.length?"exact"!==this.searchType||r?n&&r?(console.log("searching with key and type"),this.worker.postMessage({searchTerm:t,searchKey:n,searchType:r})):"approximate"===this.searchType&&this.worker.postMessage({searchTerm:t,searchKey:this.searchKey,searchType:"approximate"}):this.worker.postMessage({searchTerm:t,searchKey:this.searchKey,searchType:"exact"}):this.drugsToShow=this.drugs}showSearchResults(){this.worker.onmessage=({data:t})=>{console.log(t),0===t.length?(console.log("no results found"),this.presenetNotFoundUI()):this.drugsToShow=t,console.timeEnd("Search took: ")}}presenetNotFoundUI(){this.drugsToShow=[]}doApproximateSearch(){console.log("open AI"),this.searchType="approximate",this.doSearch(this.searchTerm),this.searchType="exact"}changeSegmentTo(t){const r=t.detail.value;"history"===r?(console.log("history"),this.storage.get("history").then(l=>{if(l){const m=JSON.parse(l);console.log(m),this.drugsToShow=m}else this.drugsToShow=[],this.noHistory=!0})):"all"===r&&(this.drugsToShow=this.drugs)}chooseToSearchBy(){return(0,P.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({header:"Select To Search By:",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:n=>{console.log("Confirm Cancel: blah")}},{text:"Ok",handler:n=>{this.searchKey=n}}],inputs:[{label:"Tradename",type:"radio",value:"tradename"},{label:"Active Ingredient",type:"radio",value:"activeingredient"},{label:"Company",type:"radio",value:"company"},{label:"Group",type:"radio",value:"group"},{label:"Pamphlet",type:"radio",value:"pamphlet"},{label:"Dosage",type:"radio",value:"dosage"},{label:"Composition",type:"radio",value:"composition"},{label:"Price",type:"radio",value:"price"},{label:"ID",type:"radio",value:"id"}]})).present()})}openDrugDetails(t){console.log(t),this.router.navigate(["app/tabs/drugs/drug",t.id]),this.saveDrugToHistory(t)}saveDrugToHistory(t){return(0,P.mG)(this,void 0,void 0,function*(){console.log("save drug to history");const n=yield this.storage.get("history");if(console.log(n),n){const r=JSON.parse(n);r.push(t),yield this.storage.set("history",JSON.stringify(r))}else yield this.storage.set("history",JSON.stringify([t]))})}getDrugImage(t){return`${E._}/assets/imgs5/drugs/${t}.jpg`}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(H.e),e.Y36(a.Br),e.Y36(N.V),e.Y36(c.F0),e.Y36(c.gz),e.Y36(J.y))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-home"]],decls:22,vars:7,consts:[["color","primary"],["slot","start"],[3,"ngModel","ngModelChange","ionChange"],["value","all"],["value","history"],["slot","end"],[3,"click"],["slot","icon-only","name","ellipsis-vertical-outline"],[3,"placeholder","ngModel","ngModelChange","ionInput"],[4,"ngIf"],["class","notfound ion-padding ion-text-center",4,"ngIf"],["approxItemHeight","100px",3,"items"],[4,"virtualItem"],[1,"notfound","ion-padding","ion-text-center"],["color","medium"],["color","primary",3,"click"],[1,"card",3,"click"],[1,"avatar"],["height","100",3,"src"],[1,"drug-details"],[1,"tradename"],["class","activeingredient",4,"ngIf"],[1,"activeingredient"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),e._UZ(3,"ion-menu-button"),e.qZA(),e.TgZ(4,"ion-segment",2),e.NdJ("ngModelChange",function(l){return n.segmentType=l})("ionChange",function(l){return n.changeSegmentTo(l)}),e.TgZ(5,"ion-segment-button",3)(6,"ion-label"),e._uU(7,"All"),e.qZA()(),e.TgZ(8,"ion-segment-button",4)(9,"ion-label"),e._uU(10,"History"),e.qZA()()(),e.TgZ(11,"ion-buttons",5)(12,"ion-button",6),e.NdJ("click",function(){return n.chooseToSearchBy()}),e._UZ(13,"ion-icon",7),e.qZA()()(),e.TgZ(14,"ion-toolbar",0)(15,"ion-searchbar",8),e.NdJ("ngModelChange",function(l){return n.searchTerm=l})("ionInput",function(l){return n.onSearchInput(l)}),e.qZA()()(),e.TgZ(16,"ion-content"),e.YNc(17,K,2,0,"h3",9),e.YNc(18,_,9,1,"div",10),e.YNc(19,B,4,0,"div",10),e.TgZ(20,"ion-virtual-scroll",11),e.YNc(21,L,11,4,"div",12),e.qZA()()),2&t&&(e.xp6(4),e.Q6J("ngModel",n.segmentType),e.xp6(11),e.MGl("placeholder","Search By ",n.searchKey.charAt(0).toUpperCase()+n.searchKey.slice(1),"..."),e.Q6J("ngModel",n.searchTerm),e.xp6(2),e.Q6J("ngIf",n.isLoading),e.xp6(1),e.Q6J("ngIf",0===n.drugsToShow.length&&!n.noHistory&&!n.isLoading),e.xp6(1),e.Q6J("ngIf",0===n.drugsToShow.length&&n.noHistory&&!n.isLoading),e.xp6(1),e.Q6J("items",n.drugsToShow))},dependencies:[h.O5,p.JJ,p.On,a.YG,a.Sm,a.W2,a.Gu,a.gu,a.Xz,a.Q$,a.fG,a.VI,a.cJ,a.GO,a.yW,a.sr,a.QI,a.j9,a.Rw,a.aJ],styles:["[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{--background: white}ion-virtual-scroll[_ngcontent-%COMP%]{width:100%;margin-top:8px}ion-virtual-scroll[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{display:flex;flex-direction:row;border-radius:12px;height:100px;background:#fafafa;box-shadow:0 2px 2px rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.2),0 1px 5px rgba(0,0,0,.12);margin:8px 16px}ion-virtual-scroll[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{padding:5px;width:20%;display:flex;justify-content:center;align-items:center}ion-virtual-scroll[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:auto;height:100%;mix-blend-mode:multiply;filter:contrast(1)}ion-virtual-scroll[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .drug-details[_ngcontent-%COMP%]{padding:5px;width:80%;display:flex;flex-direction:column;justify-content:space-around}ion-virtual-scroll[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .drug-details[_ngcontent-%COMP%]   .tradename[_ngcontent-%COMP%]{font-size:22px;font-weight:700;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}ion-virtual-scroll[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .drug-details[_ngcontent-%COMP%]   .activeingredient[_ngcontent-%COMP%]{font-size:15px;color:#777;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]}),s})();const F=[{path:"tabs",component:(()=>{class s{constructor(){}ngOnInit(){}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-tabs"]],decls:14,vars:0,consts:[["color","primary","slot","bottom"],["tab","drugs"],["name","search"],["tab","interactions"],["name","medkit"],["tab","settings"],["name","settings"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-tabs")(1,"ion-tab-bar",0)(2,"ion-tab-button",1),e._UZ(3,"ion-icon",2),e.TgZ(4,"ion-label"),e._uU(5,"Drug Search"),e.qZA()(),e.TgZ(6,"ion-tab-button",3),e._UZ(7,"ion-icon",4),e.TgZ(8,"ion-label"),e._uU(9,"Drug Interactions"),e.qZA()(),e.TgZ(10,"ion-tab-button",5),e._UZ(11,"ion-icon",6),e.TgZ(12,"ion-label"),e._uU(13,"Settings"),e.qZA()()()())},dependencies:[a.gu,a.Q$,a.yq,a.ZU,a.UN]}),s})(),children:[{path:"drugs",children:[{path:"",component:I},{path:"drug/:id",loadChildren:()=>i.e(3637).then(i.bind(i,3637)).then(s=>s.DrugDetailsPageModule)}]},{path:"interactions",children:[{path:"",loadChildren:()=>i.e(3735).then(i.bind(i,3735)).then(s=>s.InteractionsPageModule)}]},{path:"settings",children:[{path:"",loadChildren:()=>i.e(2471).then(i.bind(i,2471)).then(s=>s.SettingsPageModule)}]}]},{path:"",redirectTo:"/app/tabs/drugs",pathMatch:"full"},{path:"interactions",loadChildren:()=>i.e(3735).then(i.bind(i,3735)).then(s=>s.InteractionsPageModule)},{path:"settings",loadChildren:()=>i.e(2471).then(i.bind(i,2471)).then(s=>s.SettingsPageModule)}];let z=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[c.Bz.forChild(F),c.Bz]}),s})();const j=[{path:"",component:I}];let Y=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[c.Bz.forChild(j),c.Bz]}),s})(),W=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[h.ez,p.u5,a.Pc,Y]}),s})(),G=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[h.ez,p.u5,a.Pc,z,W]}),s})()},5260:(C,f,i)=>{i.d(f,{y:()=>a});var h=i(652),p=i(8256);let a=(()=>{class c{constructor(){h.z.setCollectionEnabled({enabled:!0})}setUserId(u){h.z.setUserId({userId:u})}setUserProperty(u,T){h.z.setUserProperty({name:u,value:T})}setSecreenName(u){h.z.setScreenName({screenName:u})}logEvent(u,T){h.z.logEvent({name:u,params:T})}}return c.\u0275fac=function(u){return new(u||c)},c.\u0275prov=p.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},649:(C,f,i)=>{i.d(f,{e:()=>T});var h=i(1135),p=i(4004),a=i(7266),c=i(8256),P=i(529),u=i(1188);let T=(()=>{class v{constructor(g,d){this.http=g,this.storage=d,this.drugs$=new h.X([]),console.log("Drugs Service"),this.getDrugs()}getDrugs(){if(this.http.get(`${a._}/api/current-api-version.json`).subscribe(g=>{console.log("current api version",g.data.version),this.storage.get("api-version").then(d=>{console.log("api version",d),d!==g&&(this.storage.set("api-version",g.data.version),this.drugs$.next([]),this.storage.remove("drugs"),console.log("drugs removed from storage"),this.getDrugs(),console.log("new drugs fetched from api"))})}),this.drugs$.getValue().length>0)return this.drugs$;this.storage.get("drugs").then(g=>{if(g){const d=JSON.parse(g);this.drugs$.next(d)}else this.http.get(a.T).pipe((0,p.U)(d=>{d.sort((S,y)=>S.tradename>y.tradename?1:S.tradename<y.tradename?-1:0),this.drugs$.next(d),this.storage.set("drugs",JSON.stringify(this.drugs$.getValue()))})).subscribe(d=>{console.log("data fetched from api")},d=>{console.log("error",d)})})}getDrugsFromLocal(){}}return v.\u0275fac=function(g){return new(g||v)(c.LFG(P.eN),c.LFG(u.V))},v.\u0275prov=c.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()}}]);